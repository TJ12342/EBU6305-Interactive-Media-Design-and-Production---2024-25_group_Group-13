<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="community.pageTitle">Community - Quadratic Equations & Parabolas</title>
    <link rel="stylesheet" href="../common/styles/main.css">
    <link rel="stylesheet" href="../common/styles/dark-mode.css">
    <link rel="stylesheet" href="styles/community.css">
    <script src="../common/scripts/i18n.js" defer></script>
</head>
<body>
    <!-- È°∂ÈÉ®ÂØºËà™Ê†è -->
    <header>
        <div class="logo">
            <h1 data-i18n="nav.home">Quadratic Equations & Parabolas</h1>
        </div>
        <nav>
            <ul>
                <li><a href="../../index.html" data-i18n="nav.home">Home</a></li>
                <li><a href="../learning/learning.html" data-i18n="nav.learning">Learning</a></li>
                <li><a href="../game/game.html" data-i18n="nav.game">Games</a></li>
                <li><a href="../test/test.html" data-i18n="nav.test">Tests</a></li>
                <li><a href="community.html" class="active" data-i18n="nav.community">Community</a></li>
            </ul>
        </nav>
        
        <div class="utility-buttons">
            <!-- ÊöóÈªëÊ®°ÂºèÂàáÊç¢ -->
            <div class="dark-mode-toggle">
                <button id="dark-mode-btn" data-i18n="common.darkMode" aria-label="Toggle dark mode">üåì</button>
            </div>
            <!-- ËØ≠Ë®ÄÂàáÊç¢ -->
            <div class="language-selector">
                <label for="language" class="visually-hidden" data-i18n="common.selectLanguage">Select Language</label>
                <select id="language" aria-label="Select language">
                    <option value="en" data-i18n="common.english">English</option>
                    <option value="zh" data-i18n="common.chinese">‰∏≠Êñá</option>
                </select>
            </div>
        </div>
    </header>

    <!-- ‰∏ªË¶ÅÂÜÖÂÆπÂå∫Âüü -->
    <main class="community-container">
        <!-- ÂØºËà™Èù¢ÂåÖÂ±ë -->
        <div class="breadcrumb">
            <a href="../../index.html" data-i18n="nav.home">Home</a> > <span data-i18n="nav.community">Community</span>
        </div>

        <!-- Ê¨¢ËøéÂå∫Âùó -->
        <section class="community-welcome">
            <h2 data-i18n="community.welcome.title">Welcome to the Learning Community</h2>
            <p data-i18n="community.welcome.description">Here, you can share your learning experiences, ask questions, participate in discussions, and interact with other math enthusiasts.</p>
            
            <div class="community-stats">
                <div class="stat-item">
                    <div class="stat-number" id="member-count">1,234</div>
                    <div class="stat-label" data-i18n="community.stats.members">Members</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="active-count">456</div>
                    <div class="stat-label" data-i18n="community.stats.active">Active Today</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="topic-count">789</div>
                    <div class="stat-label" data-i18n="community.stats.topics">Topics</div>
                </div>
            </div>
        </section>

        <!-- Á§æÂå∫‰∏ª‰ΩìÂÜÖÂÆπ -->
        <div class="community-main">
            <!-- ‰æßËæπÊ†è -->
            <aside class="community-sidebar">
                <!-- Áî®Êà∑‰ø°ÊÅØÂç°Áâá -->
                <div class="user-card">
                    <div class="user-avatar">
                        <img src="../assets/images/community/avatar-default.jpg" alt="User Avatar" id="user-avatar">
                    </div>
                    <div class="user-info">
                        <h3 class="user-name" id="user-name">Guest</h3>
                        <p class="user-status" id="login-status"><span data-i18n="community.posting.loginPrompt">Please</span> <a href="#" id="login-link" onclick="document.getElementById('login-modal').classList.remove('hidden'); return false;" data-i18n="community.posting.login">login</a> <span data-i18n="community.posting.participatePrompt">to participate in discussions</span></p>
                        <button id="edit-profile-btn" class="edit-profile-btn hidden" data-i18n="community.profile.edit">Edit Profile</button>
                    </div>
                    
                    <!-- User Achievements Section -->
                    <div class="user-achievements" id="user-achievements">
                        <div class="achievements-header">
                            <h4 data-i18n="community.achievements.title">Achievements</h4>
                        </div>
                        <div class="achievement-items">
                            <div class="achievement-item">
                                <span class="achievement-icon">üìö</span>
                                <span class="achievement-label" data-i18n="community.achievements.learning">Learning Progress:</span>
                                <span class="achievement-value" id="learning-progress">-</span>
                            </div>
                            <div class="achievement-item">
                                <span class="achievement-icon">üéÆ</span>
                                <span class="achievement-label" data-i18n="community.achievements.game">Game Score:</span>
                                <span class="achievement-value" id="game-score">-</span>
                            </div>
                            <div class="achievement-item">
                                <span class="achievement-icon">üèÜ</span>
                                <span class="achievement-label" data-i18n="community.achievements.badges">Badges:</span>
                                <span class="achievement-value" id="user-badges">-</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- User Bio Section -->
                    <div class="user-bio" id="user-bio">
                        <div class="bio-header">
                            <h4 data-i18n="community.profile.aboutMe">About Me</h4>
                        </div>
                        <p class="bio-content" id="bio-content">-</p>
                        
                        <div class="bio-header">
                            <h4 data-i18n="community.profile.interests">Interests</h4>
                        </div>
                        <p class="bio-interests" id="bio-interests">-</p>
                    </div>
                    
                    <button id="new-post-btn" disabled data-i18n="community.posting.newPost" onclick="if(currentUser) { document.getElementById('new-topic-modal').classList.remove('hidden'); } else { document.getElementById('login-modal').classList.remove('hidden'); }">Create New Topic</button>
                </div>

                <!-- ÁÉ≠Èó®ËØùÈ¢ò -->
                <div class="hot-topics">
                    <h3 data-i18n="community.hotTopics.title">Hot Topics</h3>
                    <ul id="hot-topics-list">
                        <li><a href="#">How to quickly solve quadratic equations?</a> <span class="topic-heat">üî•</span></li>
                        <li><a href="#">Applications of parabolas in physics</a> <span class="topic-heat">üî•</span></li>
                        <li><a href="#">Quadratic function transformation techniques</a></li>
                        <li><a href="#">Help: How to understand the discriminant?</a></li>
                        <li><a href="#">Sharing my parabola drawing tool</a></li>
                    </ul>
                </div>

                <!-- Á§æÂå∫ËßÑÂàô -->
                <div class="community-rules">
                    <h3 data-i18n="community.rules.title">Community Rules</h3>
                    <ul>
                        <li data-i18n="community.rules.rule1">Respect others, communicate friendly</li>
                        <li data-i18n="community.rules.rule2">Focus on math learning related topics</li>
                        <li data-i18n="community.rules.rule3">Search for similar questions before asking</li>
                        <li data-i18n="community.rules.rule4">Provide detailed explanations when sharing solutions</li>
                    </ul>
                    <a href="#" class="rules-link" data-i18n="community.rules.viewAll">View Complete Rules</a>
                </div>
                
                <!-- Star Learners Leaderboard -->
                <div class="star-learners">
                    <h3 data-i18n="community.leaderboard.title">Star Learners</h3>
                    <div class="leaderboard-description" data-i18n="community.leaderboard.description">Top users with outstanding performance in learning and games</div>
                    
                    <!-- Leaderboard entries will be dynamically populated -->
                    <div class="leaderboard-entries" id="leaderboard-entries">
                        <!-- Loading placeholder -->
                        <div class="leaderboard-loading">Loading top learners...</div>
                    </div>
                    
                    <a href="#" class="view-all-link" data-i18n="community.leaderboard.viewAll">View Full Leaderboard</a>
                </div>
            </aside>

            <!-- ‰∏ªË¶ÅÂÜÖÂÆπÂå∫ -->
            <div class="community-content">
                <!-- ÂàÜÁ±ªÊ†áÁ≠æ -->
                <div class="topic-categories">
                    <button class="category-btn active" data-category="all" data-i18n="community.categories.all">All</button>
                    <button class="category-btn" data-category="question" data-i18n="community.categories.questions">Questions</button>
                    <button class="category-btn" data-category="share" data-i18n="community.categories.experiences">Experiences</button>
                    <button class="category-btn" data-category="discuss" data-i18n="community.categories.discussions">Discussions</button>
                    <button class="category-btn" data-category="resource" data-i18n="community.categories.resources">Resources</button>
                </div>

                <!-- ÊêúÁ¥¢Ê°Ü -->
                <div class="search-bar">
                    <input type="text" id="community-search" data-i18n-placeholder="community.search.placeholder" placeholder="Search topics...">
                    <button id="search-btn" data-i18n="community.search.button">Search</button>
                </div>

                <!-- ËØùÈ¢òÂàóË°® -->
                <div class="topic-list" id="topic-list">
                    <!-- ÁΩÆÈ°∂ËØùÈ¢ò -->
                    <div class="topic-item pinned">
                        <div class="topic-icon">üìå</div>
                        <div class="topic-content">
                            <h3 class="topic-title"><a href="#">Community Guide: How to Ask and Answer</a></h3>
                            <div class="topic-meta">
                                <span class="topic-category official">Official</span>
                                <span class="topic-author">Author: Admin</span>
                                <span class="topic-time">2025-03-01</span>
                            </div>
                            <p class="topic-preview">This guide introduces how to ask high-quality questions in the community and how to provide helpful answers. Following these suggestions can make our community more efficient and friendly...</p>
                            <div class="topic-stats">
                                <span class="views">üëÅÔ∏è 1024</span>
                                <span class="replies">üí¨ 57</span>
                                <span class="likes">‚ù§Ô∏è 138</span>
                            </div>
                        </div>
                    </div>

                    <!-- ÊôÆÈÄöËØùÈ¢ò -->
                    <div class="topic-item">
                        <div class="topic-icon">‚ùì</div>
                        <div class="topic-content">
                            <h3 class="topic-title"><a href="#">How to understand the discriminant of quadratic functions?</a></h3>
                            <div class="topic-meta">
                                <span class="topic-category question">Question</span>
                                <span class="topic-author">Author: MathEnthusiast</span>
                                <span class="topic-time">2025-03-15</span>
                            </div>
                            <p class="topic-preview">I'm confused about the discriminant Œî=b¬≤-4ac of quadratic functions, especially its relationship with the graph and equation solutions. Could someone explain the geometric meaning of the discriminant in detail...</p>
                            <div class="topic-stats">
                                <span class="views">üëÅÔ∏è 256</span>
                                <span class="replies">üí¨ 12</span>
                                <span class="likes">‚ù§Ô∏è 24</span>
                            </div>
                        </div>
                    </div>

                    <div class="topic-item">
                        <div class="topic-icon">üìù</div>
                        <div class="topic-content">
                            <h3 class="topic-title"><a href="#">Understanding Quadratic Function Transformations</a></h3>
                            <div class="topic-meta">
                                <span class="topic-category share">Experience</span>
                                <span class="topic-author">Author: FunctionMaster</span>
                                <span class="topic-time">2025-03-14</span>
                            </div>
                            <p class="topic-preview">I've summarized a method for understanding quadratic function transformations, including intuitive understanding of translations, stretches, compressions, etc. This approach has helped me solve related problems quickly in exams...</p>
                            <div class="topic-stats">
                                <span class="views">üëÅÔ∏è 320</span>
                                <span class="replies">üí¨ 18</span>
                                <span class="likes">‚ù§Ô∏è 45</span>
                            </div>
                        </div>
                    </div>

                    <div class="topic-item">
                        <div class="topic-icon">üí¨</div>
                        <div class="topic-content">
                            <h3 class="topic-title"><a href="#">Real-world Applications of Parabolas</a></h3>
                            <div class="topic-meta">
                                <span class="topic-category discuss">Discussion</span>
                                <span class="topic-author">Author: PhysicsLover</span>
                                <span class="topic-time">2025-03-12</span>
                            </div>
                            <p class="topic-preview">I've been researching applications of parabolas in the real world and found many interesting examples like bridge design, satellite dishes, fountain water jets, etc. Does anyone know of other application cases for parabolas?</p>
                            <div class="topic-stats">
                                <span class="views">üëÅÔ∏è 185</span>
                                <span class="replies">üí¨ 23</span>
                                <span class="likes">‚ù§Ô∏è 37</span>
                            </div>
                        </div>
                    </div>

                    <div class="topic-item">
                        <div class="topic-icon">üìö</div>
                        <div class="topic-content">
                            <h3 class="topic-title"><a href="#">Sharing an Online Quadratic Equation Solver</a></h3>
                            <div class="topic-meta">
                                <span class="topic-category resource">Resource</span>
                                <span class="topic-author">Author: ToolExpert</span>
                                <span class="topic-time">2025-03-10</span>
                            </div>
                            <p class="topic-preview">I found a great online tool that not only solves quadratic equations but also provides detailed solution steps and graphical analysis. It's very helpful for learning quadratic equations, sharing with everyone...</p>
                            <div class="topic-stats">
                                <span class="views">üëÅÔ∏è 210</span>
                                <span class="replies">üí¨ 8</span>
                                <span class="likes">‚ù§Ô∏è 31</span>
                            </div>
                        </div>
                    </div>

                    <div class="topic-item">
                        <div class="topic-icon">‚ùì</div>
                        <div class="topic-content">
                            <h3 class="topic-title"><a href="#">How to Solve Quadratic Equations with Parameters?</a></h3>
                            <div class="topic-meta">
                                <span class="topic-category question">Question</span>
                                <span class="topic-author">Author: HighSchooler</span>
                                <span class="topic-time">2025-03-08</span>
                            </div>
                            <p class="topic-preview">I've been learning quadratic equations with parameters and encountered some difficult problems. Especially when discussing root conditions for different parameter values, are there any good solving approaches or techniques?</p>
                            <div class="topic-stats">
                                <span class="views">üëÅÔ∏è 167</span>
                                <span class="replies">üí¨ 15</span>
                                <span class="likes">‚ù§Ô∏è 19</span>
                            </div>
                        </div>
                    </div>

                    <!-- Á§∫‰æãËØùÈ¢ò -->
                    <div class="topic-item">
                        <div class="topic-vote">
                            <button class="vote-btn up-vote"><i class="fas fa-arrow-up"></i></button>
                            <span class="vote-count">42</span>
                            <button class="vote-btn down-vote"><i class="fas fa-arrow-down"></i></button>
                        </div>
                        <div class="topic-content">
                            <h3 class="topic-title">Understanding the relationship between a, b, and c in quadratic equations</h3>
                            <div class="topic-meta">
                                <span class="topic-author">Posted by <a href="#">MathEnthusiast</a></span>
                                <span class="topic-time">2 days ago</span>
                                <span class="topic-category question">Question</span>
                                <span class="topic-actions">
                                    <button class="reply-btn" data-i18n="community.actions.reply">Reply</button>
                                    <button class="delete-topic-btn" data-i18n="community.actions.delete">Delete</button>
                                </span>
                            </div>
                            <p class="topic-preview">I'm trying to understand how the coefficients a, b, and c affect the shape and position of the parabola. Can someone provide some visual examples or explanations?</p>
                            <div class="topic-footer">
                                <span class="comment-count"><i class="fas fa-comment"></i> 8 comments</span>
                                <span class="share-btn"><i class="fas fa-share-alt"></i> Share</span>
                                <span class="save-btn"><i class="far fa-bookmark"></i> Save</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÂàÜÈ°µ -->
                <div class="pagination">
                    <button class="page-btn active">1</button>
                    <button class="page-btn">2</button>
                    <button class="page-btn">3</button>
                    <button class="page-btn">4</button>
                    <button class="page-btn">5</button>
                    <button class="page-btn">...</button>
                    <button class="page-btn">Next ¬ª</button>
                </div>
            </div>
        </div>
    </main>

    <!-- È°µËÑö -->
    <footer>
        <div class="footer-content">
            <div class="footer-contact">
                <h3 data-i18n="common.contact">Contact Us</h3>
                <p data-i18n="common.email">Email: contact@quadraticlearning.com</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p data-i18n="common.copyright">¬© 2025 Quadratic Equations & Parabolas Interactive Learning. All rights reserved.</p>
            <p><a href="../common/privacy.html" data-i18n="common.privacy">Privacy Policy</a> | <a href="../common/terms.html" data-i18n="common.terms">Terms of Use</a></p>
        </div>
    </footer>

    <!-- ÁôªÂΩïÊ®°ÊÄÅÊ°Ü -->
    <div id="login-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close" onclick="document.getElementById('login-modal').classList.add('hidden');">&times;</span>
            <h2 data-i18n="community.posting.loginTitle">Login</h2>
            <form id="login-form">
                <div class="form-group">
                    <label for="username" data-i18n="community.posting.username">Username</label>
                    <input type="text" id="username" required>
                </div>
                <div class="form-group">
                    <label for="password" data-i18n="community.posting.password">Password</label>
                    <input type="password" id="password" required>
                </div>
                <button type="submit" class="btn btn-primary" data-i18n="community.posting.loginButton">Login</button>
                <p class="register-link"><span data-i18n="community.posting.noAccount">Don't have an account?</span> <a href="#" id="register-link" data-i18n="community.posting.register">Register</a></p>
            </form>
        </div>
    </div>

    <!-- ÂàõÂª∫Êñ∞ËØùÈ¢òÊ®°ÊÄÅÊ°Ü -->
    <div id="new-topic-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 data-i18n="community.posting.newPost">Create New Topic</h2>
            <form id="new-topic-form">
                <div class="form-group">
                    <label for="topic-title" data-i18n="community.posting.title">Title</label>
                    <input type="text" id="topic-title" required>
                </div>
                <div class="form-group">
                    <label for="topic-category" data-i18n="community.posting.category">Category</label>
                    <select id="topic-category" required>
                        <option value="">Select Category</option>
                        <option value="question" data-i18n="community.categories.questions">Questions</option>
                        <option value="share" data-i18n="community.categories.experiences">Experiences</option>
                        <option value="discuss" data-i18n="community.categories.discussions">Discussions</option>
                        <option value="resource" data-i18n="community.categories.resources">Resources</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="topic-content" data-i18n="community.posting.content">Content</label>
                    <textarea id="topic-content" rows="6" required></textarea>
                </div>
                <div class="form-buttons">
                    <button type="button" class="btn btn-cancel" id="cancel-topic" data-i18n="community.posting.cancel">Cancel</button>
                    <button type="submit" class="btn btn-primary" data-i18n="community.posting.post">Post Topic</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ÂÆåÊï¥ÊéíË°åÊ¶úÊ®°ÊÄÅÊ°Ü -->
    <div id="leaderboard-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal" onclick="document.getElementById('leaderboard-modal').classList.add('hidden');">&times;</span>
            <h2 data-i18n="community.leaderboard.fullTitle">Star Learners Leaderboard</h2>
            <div class="full-leaderboard-container">
                <div class="leaderboard-tabs">
                    <button class="leaderboard-tab active" data-tab="score" data-i18n="community.leaderboard.tabScore">Game Score</button>
                    <button class="leaderboard-tab" data-tab="progress" data-i18n="community.leaderboard.tabProgress">Learning Progress</button>
                    <button class="leaderboard-tab" data-tab="contributions" data-i18n="community.leaderboard.tabContributions">Community Contributions</button>
                </div>
                <div class="leaderboard-table-container">
                    <table class="leaderboard-table">
                        <thead>
                            <tr>
                                <th data-i18n="community.leaderboard.columnRank">Rank</th>
                                <th data-i18n="community.leaderboard.columnUser">User</th>
                                <th data-i18n="community.leaderboard.columnScore">Score</th>
                                <th data-i18n="community.leaderboard.columnBadges">Badges</th>
                            </tr>
                        </thead>
                        <tbody id="full-leaderboard-body">
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Â∏ñÂ≠êËØ¶ÊÉÖÊ®°ÊÄÅÊ°Ü -->
    <div id="post-detail-modal" class="modal hidden">
        <div class="modal-content post-detail-content">
            <span class="close-modal" onclick="document.getElementById('post-detail-modal').classList.add('hidden');">&times;</span>
            <div class="post-detail-container">
                <!-- Â∏ñÂ≠êÂÜÖÂÆπÂå∫ -->
                <div class="post-detail-header">
                    <div class="post-category" id="detail-category">Category</div>
                    <h2 class="post-title" id="detail-title">Post Title</h2>
                    <div class="post-meta">
                        <div class="post-author">
                            <img src="../assets/images/community/avatar-default.jpg" class="author-avatar" id="detail-avatar">
                            <span id="detail-author">Author Name</span>
                        </div>
                        <div class="post-date" id="detail-date">2025-03-15</div>
                    </div>
                </div>
                
                <div class="post-detail-body" id="detail-content">
                    Post content will be displayed here...
                </div>
                
                <div class="post-detail-actions">
                    <button class="action-btn like-btn" id="detail-like-btn">
                        <span class="action-icon">‚ù§Ô∏è</span>
                        <span class="action-count" id="detail-likes">0</span>
                        <span class="action-text" data-i18n="community.post.like">Like</span>
                    </button>
                    <button class="action-btn comment-btn">
                        <span class="action-icon">üí¨</span>
                        <span class="action-count" id="detail-comments">0</span>
                        <span class="action-text" data-i18n="community.post.comment">Comment</span>
                    </button>
                    <button class="action-btn share-btn">
                        <span class="action-icon">üîó</span>
                        <span class="action-text" data-i18n="community.post.share">Share</span>
                    </button>
                </div>
                
                <!-- ËØÑËÆ∫Âå∫ -->
                <div class="post-comments-section">
                    <h3 class="comments-title" data-i18n="community.post.commentsTitle">Comments</h3>
                    
                    <!-- ËØÑËÆ∫Ë°®Âçï -->
                    <div class="comment-form" id="comment-form">
                        <div class="comment-form-placeholder" id="comment-placeholder" data-i18n="community.post.loginToComment">Please login to add a comment</div>
                        <div class="comment-form-content hidden" id="comment-form-content">
                            <div class="comment-user">
                                <img src="../assets/images/community/avatar-default.jpg" class="comment-avatar" id="current-user-avatar">
                                <span id="current-user-name">Username</span>
                            </div>
                            <textarea class="comment-input" id="comment-input" placeholder="Write your comment here..." data-i18n-placeholder="community.post.commentPlaceholder"></textarea>
                            <div class="comment-actions">
                                <button class="btn btn-primary" id="submit-comment" data-i18n="community.post.submitComment">Post Comment</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ËØÑËÆ∫ÂàóË°® -->
                    <div class="comments-list" id="comments-list">
                        <!-- ËØÑËÆ∫Â∞ÜÁî±JavaScriptÂä®ÊÄÅÊ∑ªÂä† -->
                        <div class="comments-empty hidden" data-i18n="community.post.noComments">No comments yet. Be the first to comment!</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ‰∏™‰∫∫ËµÑÊñôÁºñËæëÊ®°ÊÄÅÊ°Ü -->
    <div id="profile-edit-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal" onclick="document.getElementById('profile-edit-modal').classList.add('hidden');">&times;</span>
            <h2 data-i18n="community.profile.editTitle">Edit Profile</h2>
            <form id="profile-edit-form">
                <div class="form-group">
                    <label for="edit-username" data-i18n="community.profile.username">Username</label>
                    <input type="text" id="edit-username" required>
                </div>
                
                <div class="form-group">
                    <label for="edit-avatar" data-i18n="community.profile.avatar">Profile Picture</label>
                    <div class="avatar-selection">
                        <div class="current-avatar">
                            <img src="../assets/images/community/avatar-default.jpg" id="current-avatar-preview">
                        </div>
                        <div class="avatar-options">
                            <div class="avatar-option selected" data-avatar="../assets/images/community/avatar-default.jpg">
                                <img src="../assets/images/community/avatar-default.jpg">
                            </div>
                            <div class="avatar-option" data-avatar="../assets/images/community/avatar-default.jpg">
                                <img src="../assets/images/community/avatar-default.jpg">
                            </div>
                            <div class="avatar-option" data-avatar="../assets/images/community/avatar-default.jpg">
                                <img src="../assets/images/community/avatar-default.jpg">
                            </div>
                            <div class="avatar-option" data-avatar="../assets/images/community/avatar-default.jpg">
                                <img src="../assets/images/community/avatar-default.jpg">
                            </div>
                        </div>
                        <input type="hidden" id="edit-avatar" value="../assets/images/community/avatar-default.jpg">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="edit-bio" data-i18n="community.profile.bio">About Me</label>
                    <textarea id="edit-bio" rows="3" placeholder="Tell the community about yourself..."></textarea>
                </div>
                
                <!-- Ê∑ªÂä†ÊÄßÂà´ÈÄâÈ°π -->
                <div class="form-group">
                    <label for="edit-gender" data-i18n="community.profile.gender">Gender</label>
                    <select id="edit-gender">
                        <option value="" data-i18n="community.profile.genderSelect">Please select</option>
                        <option value="male" data-i18n="community.profile.genderMale">Male</option>
                        <option value="female" data-i18n="community.profile.genderFemale">Female</option>
                        <option value="nonbinary" data-i18n="community.profile.genderNonBinary">Non-Binary</option>
                        <option value="notsay" data-i18n="community.profile.genderNotSay">Prefer not to say</option>
                        <option value="other" data-i18n="community.profile.genderOther">Other</option>
                    </select>
                    <input type="text" id="edit-gender-other" class="hidden" placeholder="Please specify" data-i18n-placeholder="community.profile.genderSpecify">
                </div>
                
                <!-- Ê∑ªÂä†‰ª£ËØçÈÄâÈ°π -->
                <div class="form-group">
                    <label for="edit-pronouns" data-i18n="community.profile.pronouns">Pronouns</label>
                    <select id="edit-pronouns">
                        <option value="" data-i18n="community.profile.pronounsSelect">Please select</option>
                        <option value="he/him" data-i18n="community.profile.pronounsHe">He/Him</option>
                        <option value="she/her" data-i18n="community.profile.pronounsShe">She/Her</option>
                        <option value="they/them" data-i18n="community.profile.pronounsThey">They/Them</option>
                        <option value="notsay" data-i18n="community.profile.pronounsNotSay">Prefer not to say</option>
                        <option value="other" data-i18n="community.profile.pronounsOther">Other</option>
                    </select>
                    <input type="text" id="edit-pronouns-other" class="hidden" placeholder="Please specify" data-i18n-placeholder="community.profile.pronounsSpecify">
                </div>
                
                <div class="form-group">
                    <label for="edit-interests" data-i18n="community.profile.interests">Interests</label>
                    <input type="text" id="edit-interests" placeholder="e.g., Algebra, Geometry, Physics...">
                </div>
                
                <!-- Ê∑ªÂä†‰∏™‰∫∫ÈöêÁßÅÈÄâÈ°π -->
                <div class="form-group">
                    <label data-i18n="community.profile.privacyOptions">Privacy Options</label>
                    <div class="checkbox-group">
                        <input type="checkbox" id="edit-show-gender" checked>
                        <label for="edit-show-gender" data-i18n="community.profile.showGender">Show gender on profile</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="edit-show-pronouns" checked>
                        <label for="edit-show-pronouns" data-i18n="community.profile.showPronouns">Show pronouns on profile</label>
                    </div>
                </div>
                
                <div class="form-buttons">
                    <button type="button" class="btn btn-cancel" onclick="document.getElementById('profile-edit-modal').classList.add('hidden');" data-i18n="community.profile.cancel">Cancel</button>
                    <button type="submit" class="btn btn-primary" data-i18n="community.profile.save">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Âà†Èô§Á°ÆËÆ§Ê®°ÊÄÅÊ°Ü -->
    <div id="delete-confirm-modal" class="modal hidden">
        <div class="modal-content" style="max-width: 400px;">
            <span class="close-modal" onclick="document.getElementById('delete-confirm-modal').classList.add('hidden');">&times;</span>
            <h2 data-i18n="community.actions.confirmDelete">Confirm Deletion</h2>
            <p data-i18n="community.actions.deleteWarning">This action cannot be undone. Are you sure you want to proceed?</p>
            <div class="modal-actions">
                <button id="cancel-delete-btn" class="secondary-btn" data-i18n="community.actions.cancel">Cancel</button>
                <button id="confirm-delete-btn" class="danger-btn" data-i18n="community.actions.confirm">Delete</button>
            </div>
        </div>
    </div>

    <!-- JavaScript Êñá‰ª∂ -->
    <script src="../common/scripts/main.js"></script>
    <script src="../common/scripts/dark-mode.js"></script>
    <script src="scripts/community.js"></script>

    <!-- Á§æÂå∫ÂäüËÉΩÁöÑÊú¨Âú∞Â≠òÂÇ®ËÑöÊú¨ -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log("Community script loaded");
        
        // ÂàùÂßãÂåñÂèòÈáè
        let currentUser = null;
        let communityPosts = [];

        // Mock learning and game data for demo purposes
        const mockUserAchievements = {
            "MathEnthusiast": {
                learningProgress: "75% Complete",
                gameScore: "850 Points",
                badges: ["Problem Solver", "Fast Learner"]
            },
            "FunctionMaster": {
                learningProgress: "92% Complete",
                gameScore: "1240 Points",
                badges: ["Quadratic Master", "Top Contributor", "Quiz Champion"]
            },
            "PhysicsLover": {
                learningProgress: "68% Complete",
                gameScore: "720 Points",
                badges: ["Persistent Learner"]
            },
            "ToolExpert": {
                learningProgress: "81% Complete",
                gameScore: "960 Points",
                badges: ["Resource Finder", "Helper"]
            },
            "HighSchooler": {
                learningProgress: "45% Complete",
                gameScore: "520 Points",
                badges: ["Newcomer"]
            }
        };
        
        // Áî®Êà∑‰∏™‰∫∫ËµÑÊñôÊï∞ÊçÆ
        const userProfiles = {
            "MathEnthusiast": {
                bio: "È´ò‰∏≠Êï∞Â≠¶ÊïôÂ∏àÔºåÂØπÊï∞Â≠¶ÊïôËÇ≤Âíå‰∫åÊ¨°ÊñπÁ®ãÊúâÂº∫ÁÉàÂÖ¥Ë∂£„ÄÇÂñúÊ¨¢Â∏ÆÂä©Â≠¶ÁîüÁêÜËß£Êï∞Â≠¶Ê¶ÇÂøµ„ÄÇ",
                interests: "Êï∞Â≠¶ÊïôËÇ≤, ‰∫åÊ¨°ÊñπÁ®ã, Êï∞Â≠¶Ëß£È¢ò, ÊïôÂ≠¶ÊñπÊ≥ï"
            },
            "FunctionMaster": {
                bio: "Êï∞Â≠¶‰∏ì‰∏öÁ†îÁ©∂ÁîüÔºå‰∏ìÊ≥®‰∫éÂáΩÊï∞ÁêÜËÆ∫ÂíåÂõæÂΩ¢ÂàÜÊûê„ÄÇÂú®Êï∞Â≠¶Á´ûËµõ‰∏≠Ëé∑ÂæóËøáÂ§öÈ°πÂ•ñÂä±„ÄÇ",
                interests: "ÂáΩÊï∞ÂèòÊç¢, ÂõæÂΩ¢ÂàÜÊûê, Êï∞Â≠¶Á´ûËµõ, È´òÁ≠âÊï∞Â≠¶"
            },
            "PhysicsLover": {
                bio: "Áâ©ÁêÜÂ≠¶‰∏ì‰∏öÂ≠¶ÁîüÔºåÂØπÊï∞Â≠¶ÂíåÁâ©ÁêÜÁöÑ‰∫§ÂèâÂ∫îÁî®ÁâπÂà´ÊÑüÂÖ¥Ë∂£„ÄÇÁ†îÁ©∂ÊäõÁâ©Á∫øÂú®Áâ©ÁêÜ‰∏≠ÁöÑÂ∫îÁî®„ÄÇ",
                interests: "Áâ©ÁêÜÂ∫îÁî®, ÊäõÁâ©Á∫øÁêÜËÆ∫, ËøêÂä®ËΩ®Ëøπ, Áâ©ÁêÜÂª∫Ê®°"
            },
            "ToolExpert": {
                bio: "ËΩØ‰ª∂Â∑•Á®ãÂ∏àÔºåÁÉ≠Ë°∑‰∫éÂºÄÂèëÊï∞Â≠¶ÊïôËÇ≤Â∑•ÂÖ∑„ÄÇÁõ∏‰ø°ÊäÄÊúØËÉΩËÆ©Êï∞Â≠¶Â≠¶‰π†Êõ¥ÊúâË∂£„ÄÇ",
                interests: "ÊïôËÇ≤ËΩØ‰ª∂, Êï∞Â≠¶Â∑•ÂÖ∑, ÁºñÁ®ã, ÂèØËßÜÂåñ"
            },
            "HighSchooler": {
                bio: "È´ò‰∏≠ÁîüÔºåÊ≠£Âú®Â≠¶‰π†‰∫åÊ¨°ÊñπÁ®ã„ÄÇÂ∏åÊúõÈÄöËøáÁ§æÂå∫Ëé∑ÂæóÊõ¥Â§öÂ∏ÆÂä©Âíå‰∫§ÊµÅ„ÄÇ",
                interests: "Âü∫Á°ÄÊï∞Â≠¶, Â≠¶‰π†ÊäÄÂ∑ß, ‰∫åÊ¨°ÊñπÁ®ãÊ±ÇËß£"
            }
        };
        
        // Mock data for leaderboard
        const leaderboardData = [
            {
                username: "FunctionMaster",
                totalScore: 1240,
                progressPercent: 92,
                badges: ["ü•á", "‚≠ê"],
                avatar: "../assets/images/community/avatar-default.jpg"
            },
            {
                username: "ToolExpert",
                totalScore: 960,
                progressPercent: 81,
                badges: ["üéØ"],
                avatar: "../assets/images/community/avatar-default.jpg"
            },
            {
                username: "MathEnthusiast",
                totalScore: 850,
                progressPercent: 75,
                badges: ["üîç"],
                avatar: "../assets/images/community/avatar-default.jpg"
            },
            {
                username: "PhysicsLover",
                totalScore: 720,
                progressPercent: 68,
                badges: [],
                avatar: "../assets/images/community/avatar-default.jpg"
            },
            {
                username: "HighSchooler",
                totalScore: 520,
                progressPercent: 45,
                badges: [],
                avatar: "../assets/images/community/avatar-default.jpg"
            }
        ];

        const defaultPosts = [
            {
                id: 1000,
                title: "How to understand the discriminant of quadratic functions?",
                category: "question",
                content: "I'm confused about the discriminant Œî=b¬≤-4ac of quadratic functions, especially its relationship with the graph and equation solutions. Could someone explain the geometric meaning of the discriminant in detail?",
                author: "MathEnthusiast",
                date: "2025-03-15",
                views: 256,
                likes: 24,
                replies: []
            },
            {
                id: 1001,
                title: "Understanding Quadratic Function Transformations",
                category: "share",
                content: "I've summarized a method for understanding quadratic function transformations, including intuitive understanding of translations, stretches, compressions, etc. This approach has helped me solve related problems quickly in exams.",
                author: "FunctionMaster",
                date: "2025-03-14",
                views: 320,
                likes: 45,
                replies: []
            },
            {
                id: 1002,
                title: "Real-world Applications of Parabolas",
                category: "discuss",
                content: "I've been researching applications of parabolas in the real world and found many interesting examples like bridge design, satellite dishes, fountain water jets, etc. Does anyone know of other application cases for parabolas?",
                author: "PhysicsLover",
                date: "2025-03-12",
                views: 185,
                likes: 37,
                replies: []
            },
            {
                id: 1003,
                title: "Sharing an Online Quadratic Equation Solver",
                category: "resource",
                content: "I found a great online tool that not only solves quadratic equations but also provides detailed solution steps and graphical analysis. It's very helpful for learning quadratic equations, sharing with everyone!",
                author: "ToolExpert",
                date: "2025-03-10",
                views: 210,
                likes: 31,
                replies: []
            },
            {
                id: 1004,
                title: "How to Solve Quadratic Equations with Parameters?",
                category: "question",
                content: "I've been learning quadratic equations with parameters and encountered some difficult problems. Especially when discussing root conditions for different parameter values, are there any good solving approaches or techniques?",
                author: "HighSchooler",
                date: "2025-03-08",
                views: 167,
                likes: 19,
                replies: []
            }
        ];

        // Sample comments data for demo purposes
        const sampleComments = {
            1000: [
                {
                    id: 1,
                    postId: 1000,
                    author: "FunctionMaster",
                    content: "The discriminant is key to understanding the nature of solutions. When Œî > 0, the parabola crosses the x-axis at two points, meaning the equation has two real solutions. When Œî = 0, the parabola is tangent to the x-axis, giving one real solution. When Œî < 0, the parabola doesn't cross the x-axis, indicating no real solutions.",
                    date: "2025-03-15",
                    likes: 8
                },
                {
                    id: 2,
                    postId: 1000,
                    author: "ToolExpert",
                    content: "Another way to think about it: the discriminant tells you about the symmetry of the roots. The formula x = (-b ¬± ‚àö(b¬≤-4ac))/2a shows that the roots are equidistant from -b/2a, which is the axis of symmetry of the parabola.",
                    date: "2025-03-16",
                    likes: 5
                }
            ],
            1001: [
                {
                    id: 3,
                    postId: 1001,
                    author: "MathEnthusiast",
                    content: "This is really helpful! Could you share more about how you approach vertical and horizontal stretches?",
                    date: "2025-03-14",
                    likes: 3
                }
            ],
            1002: [
                {
                    id: 4,
                    postId: 1002,
                    author: "HighSchooler",
                    content: "Headlight reflectors in cars also use parabolic shapes to focus light!",
                    date: "2025-03-13",
                    likes: 2
                },
                {
                    id: 5,
                    postId: 1002,
                    author: "ToolExpert",
                    content: "Solar cookers are another great example - they use parabolic reflectors to focus sunlight for cooking.",
                    date: "2025-03-13",
                    likes: 4
                }
            ],
            1003: [],
            1004: [
                {
                    id: 6,
                    postId: 1004,
                    author: "FunctionMaster",
                    content: "For parameter problems, I recommend analyzing the discriminant as a function of the parameter. This helps identify critical values where the nature of solutions changes.",
                    date: "2025-03-09",
                    likes: 7
                }
            ]
        };

        // DOMÂÖÉÁ¥†ÂºïÁî®
        const loginModal = document.getElementById('login-modal');
        const newPostBtn = document.getElementById('new-post-btn');
        const newTopicModal = document.getElementById('new-topic-modal');
        const newTopicForm = document.getElementById('new-topic-form');
        const loginForm = document.getElementById('login-form');
        const topicList = document.getElementById('topic-list');
        const closeModals = document.querySelectorAll('.close, .close-modal');
        const cancelButton = document.getElementById('cancel-topic');
        const categoryButtons = document.querySelectorAll('.category-btn');

        // ÂàùÂßãÂåñÁ§æÂå∫
        function initCommunity() {
            console.log("Initializing community");
            
            // Á°Æ‰øùÁôªÂΩïÈìæÊé•‰∫ã‰ª∂ÁªëÂÆöÊ≠£Â∏∏Â∑•‰Ωú
            document.querySelectorAll('#login-link, #new-post-btn, .close, .close-modal, #cancel-topic').forEach(el => {
                console.log("Found element to bind event:", el.id || el.className);
            });
            
            // Á°Æ‰øùÁôªÂΩïË°®ÂçïÊèê‰∫§‰∫ã‰ª∂Ê≠£Â∏∏Â∑•‰Ωú
            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                console.log("Login form submitted directly");
                
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                
                if (username && password) {
                    // Get achievements data if available for this user
                    const achievements = mockUserAchievements[username] || {
                        learningProgress: "10% Complete",
                        gameScore: "50 Points",
                        badges: ["Newcomer"]
                    };
                    
                    // ÁÆÄÂçïÁôªÂΩïÈÄªËæë
                    currentUser = {
                        username: username,
                        avatar: '../assets/images/community/avatar-default.jpg',
                        achievements: achievements
                    };
                    
                    // ‰øùÂ≠òÁî®Êà∑‰ø°ÊÅØ
                    localStorage.setItem('communityUser', JSON.stringify(currentUser));
                    
                    // Êõ¥Êñ∞UI
                    updateUserUI(currentUser);
                    updateStats();
                    
                    // ÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü
                    document.getElementById('login-modal').classList.add('hidden');
                    
                    // Ê∏ÖÁ©∫Ë°®Âçï
                    document.getElementById('username').value = '';
                    document.getElementById('password').value = '';
                    
                    console.log("User logged in:", currentUser.username);
                }
            });
            
            // ‰ªélocalStorageËé∑ÂèñÁî®Êà∑Êï∞ÊçÆ
            const savedUser = localStorage.getItem('communityUser');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    console.log("User loaded:", currentUser);
                    updateUserUI(currentUser);
                } catch (e) {
                    console.error("Error parsing user data:", e);
                    localStorage.removeItem('communityUser');
                }
            }
            
            // ‰ªélocalStorageËé∑ÂèñÂ∏ñÂ≠êÊï∞ÊçÆ
            let savedPosts = localStorage.getItem('communityPosts');
            if (savedPosts) {
                try {
                    communityPosts = JSON.parse(savedPosts);
                    console.log("Posts loaded:", communityPosts.length);
                } catch (e) {
                    console.error("Error parsing posts data:", e);
                    localStorage.removeItem('communityPosts');
                    communityPosts = [...defaultPosts];
                    localStorage.setItem('communityPosts', JSON.stringify(communityPosts));
                }
            } else {
                // Â¶ÇÊûúÊ≤°Êúâ‰øùÂ≠òÁöÑÂ∏ñÂ≠êÔºå‰ΩøÁî®ÈªòËÆ§Â∏ñÂ≠ê
                console.log("Using default posts");
                communityPosts = [...defaultPosts];
                localStorage.setItem('communityPosts', JSON.stringify(communityPosts));
            }
            
            // Ê∏ÖÈô§È°µÈù¢‰∏äÁöÑÈªòËÆ§Â∏ñÂ≠êÔºå‰ª•‰æøÈáçÊñ∞Ê∏≤Êüì
            clearDefaultPosts();
            
            // Ê∏≤ÊüìÂ∏ñÂ≠êÂíåÊõ¥Êñ∞ÁªüËÆ°
            renderPosts();
            updateStats();
            
            // Ê∏≤ÊüìÊéíË°åÊ¶úÊï∞ÊçÆ
            renderLeaderboard();
            
            // ÁªëÂÆö‰∫ã‰ª∂ÁõëÂê¨Âô®
            bindEventListeners();
        }
        
        // Ê∏ÖÈô§È°µÈù¢‰∏äÁöÑÈªòËÆ§Â∏ñÂ≠êÔºà‰øùÁïôÁΩÆÈ°∂Â∏ñÂ≠êÔºâ
        function clearDefaultPosts() {
            const pinnedPost = topicList.querySelector('.pinned');
            const nonPinnedPosts = topicList.querySelectorAll('.topic-item:not(.pinned)');
            
            // ÁßªÈô§ÈùûÁΩÆÈ°∂Â∏ñÂ≠ê
            nonPinnedPosts.forEach(post => post.remove());
            
            // Â¶ÇÊûúÁΩÆÈ°∂Â∏ñÂ≠êÂ≠òÂú®Ôºå‰øùÁïôÂÆÉ
            if (pinnedPost) {
                topicList.innerHTML = '';
                topicList.appendChild(pinnedPost);
            }
        }

        // Êõ¥Êñ∞Áî®Êà∑ÁïåÈù¢
        function updateUserUI(user) {
            console.log("Updating UI for user:", user ? user.username : "Guest");
            
            const userNameElement = document.getElementById('user-name');
            const loginStatusElement = document.getElementById('login-status');
            const userAchievementsElement = document.getElementById('user-achievements');
            const userBioElement = document.getElementById('user-bio');
            const editProfileBtn = document.getElementById('edit-profile-btn');
            
            if (!userNameElement || !loginStatusElement) {
                console.error("Required UI elements not found");
                return;
            }
            
            if (user) {
                // Áî®Êà∑Â∑≤ÁôªÂΩï
                userNameElement.textContent = user.username;
                loginStatusElement.innerHTML = `<span>${user.username}</span> ¬∑ <a href="#" id="logout-link">Logout</a>`;
                newPostBtn.disabled = false;
                
                // ÊòæÁ§∫ÁºñËæëËµÑÊñôÊåâÈíÆ
                if (editProfileBtn) {
                    editProfileBtn.classList.remove('hidden');
                    editProfileBtn.addEventListener('click', openProfileEditor);
                }
                
                // ÊòæÁ§∫Áî®Êà∑ÁÆÄ‰ªã
                if (userBioElement) {
                    userBioElement.style.display = 'block';
                    
                    // Ëé∑ÂèñÁî®Êà∑ÁÆÄ‰ªãÊï∞ÊçÆ
                    const profile = user.profile || userProfiles[user.username] || {
                        bio: "Ëøô‰∏™Áî®Êà∑ËøòÊ≤°ÊúâÊ∑ªÂä†‰∏™‰∫∫ÁÆÄ‰ªã„ÄÇ",
                        interests: "Êú™ÊåáÂÆöÂÖ¥Ë∂£"
                    };
                    
                    // Êõ¥Êñ∞ÁÆÄ‰ªãUI
                    document.getElementById('bio-content').textContent = profile.bio;
                    document.getElementById('bio-interests').textContent = profile.interests;
                }
                
                // Show user achievements if available
                if (userAchievementsElement) {
                    userAchievementsElement.style.display = 'block';
                    
                    // Try to get user achievements data
                    const achievements = mockUserAchievements[user.username] || {
                        learningProgress: "10% Complete",
                        gameScore: "50 Points",
                        badges: ["Newcomer"]
                    };
                    
                    // Update achievements UI
                    document.getElementById('learning-progress').textContent = achievements.learningProgress;
                    document.getElementById('game-score').textContent = achievements.gameScore;
                    document.getElementById('user-badges').textContent = achievements.badges.join(", ");
                }
                
                // Ê∑ªÂä†ÁôªÂá∫‰∫ã‰ª∂ÁõëÂê¨
                const logoutLink = document.getElementById('logout-link');
                if (logoutLink) {
                    logoutLink.addEventListener('click', function(e) {
                        e.preventDefault();
                        logout();
                    });
                }
            } else {
                // Áî®Êà∑Êú™ÁôªÂΩï
                userNameElement.textContent = 'Guest';
                
                // ÈöêËóèÁºñËæëËµÑÊñôÊåâÈíÆ
                if (editProfileBtn) {
                    editProfileBtn.classList.add('hidden');
                }
                
                // ÈöêËóèÁî®Êà∑ÁÆÄ‰ªã
                if (userBioElement) {
                    userBioElement.style.display = 'none';
                }
                
                // Hide achievements section for guest users
                if (userAchievementsElement) {
                    userAchievementsElement.style.display = 'none';
                }
                
                const loginPrompt = document.querySelector('[data-i18n="community.posting.loginPrompt"]') ? 
                    document.querySelector('[data-i18n="community.posting.loginPrompt"]').textContent : 'Please';
                const loginText = document.querySelector('[data-i18n="community.posting.login"]') ? 
                    document.querySelector('[data-i18n="community.posting.login"]').textContent : 'login';
                const participateText = document.querySelector('[data-i18n="community.posting.participatePrompt"]') ? 
                    document.querySelector('[data-i18n="community.posting.participatePrompt"]').textContent : 'to participate in discussions';
                
                loginStatusElement.innerHTML = 
                    `<span>${loginPrompt}</span> <a href="#" id="login-link">${loginText}</a> <span>${participateText}</span>`;
                newPostBtn.disabled = true;
                
                // ÁôªÂΩïÈìæÊé•ÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®Â∞ÜÂú®bindEventListenersÂáΩÊï∞‰∏≠ÁªëÂÆö
            }
        }

        // ÁôªÂá∫ÂäüËÉΩ
        function logout() {
            console.log("User logging out");
            currentUser = null;
            localStorage.removeItem('communityUser');
            updateUserUI(null);
            bindEventListeners(); // ÈáçÊñ∞ÁªëÂÆöÁôªÂΩïÈìæÊé•‰∫ã‰ª∂
            updateStats();
        }

        // Ê∏≤ÊüìÂ∏ñÂ≠êÂàóË°®
        function renderPosts() {
            console.log("Rendering posts");
            
            // ‰øùÂ≠òÁΩÆÈ°∂Â∏ñÂ≠ê
            const pinnedPost = topicList.querySelector('.pinned');
            topicList.innerHTML = '';
            
            if (pinnedPost) {
                topicList.appendChild(pinnedPost);
            }
            
            // ÊåâÊó•ÊúüÊéíÂ∫èÂ∏ñÂ≠êÔºàÈôçÂ∫èÔºâ
            communityPosts.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Ê∏≤ÊüìÊØè‰∏™Â∏ñÂ≠ê
            communityPosts.forEach(post => {
                const postElement = createPostElement(post);
                topicList.appendChild(postElement);
            });
            
            // ‰∏∫Â∏ñÂ≠êÊ∑ªÂä†‰∫§‰∫í‰∫ã‰ª∂
            addPostInteractions();
        }
        
        // ‰∏∫Â∏ñÂ≠êÊ∑ªÂä†‰∫§‰∫í‰∫ã‰ª∂
        function addPostInteractions() {
            // Ê∑ªÂä†ÁÇπËµû‰∫ã‰ª∂
            document.querySelectorAll('.topic-item:not(.pinned) .likes').forEach(likeElement => {
                likeElement.style.cursor = 'pointer';
                likeElement.addEventListener('click', function() {
                    const postId = this.closest('.topic-item').dataset.postId;
                    const post = communityPosts.find(p => p.id == postId);
                    
                    if (!post) return;
                    
                    if (currentUser) {
                        post.likes++;
                        updatePostInStorage(post);
                        this.innerHTML = `‚ù§Ô∏è ${post.likes}`;
                    } else {
                        alert('ËØ∑ÂÖàÁôªÂΩïÂêéÂÜçÁÇπËµû');
                        loginModal.classList.remove('hidden');
                    }
                });
            });
            
            // Ê∑ªÂä†Â∏ñÂ≠êÊü•Áúã‰∫ã‰ª∂
            document.querySelectorAll('.topic-item:not(.pinned) .topic-title a').forEach(titleElement => {
                titleElement.addEventListener('click', function(e) {
                    e.preventDefault();
                    const postId = this.closest('.topic-item').dataset.postId;
                    const post = communityPosts.find(p => p.id == postId);
                    
                    if (!post) return;
                    
                    post.views++;
                    updatePostInStorage(post);
                    this.closest('.topic-item').querySelector('.views').innerHTML = `üëÅÔ∏è ${post.views}`;
                    
                    // ÊâìÂºÄÂ∏ñÂ≠êËØ¶ÊÉÖËÄå‰∏çÊòØÊòæÁ§∫Ë≠¶ÂëäÊ°Ü
                    openPostDetail(post);
                });
            });
            
            // ÁÇπÂáªÂõûÂ§çÊï∞‰πüÊâìÂºÄÂ∏ñÂ≠êËØ¶ÊÉÖ
            document.querySelectorAll('.topic-item:not(.pinned) .replies').forEach(repliesElement => {
                repliesElement.style.cursor = 'pointer';
                repliesElement.addEventListener('click', function(e) {
                    const postId = this.closest('.topic-item').dataset.postId;
                    const post = communityPosts.find(p => p.id == postId);
                    
                    if (post) {
                        openPostDetail(post);
                    }
                });
            });
        }

        // ÊâìÂºÄÂ∏ñÂ≠êËØ¶ÊÉÖ
        function openPostDetail(post) {
            console.log("Opening post detail for:", post.id);
            
            // ËÆæÁΩÆÂ∏ñÂ≠êËØ¶ÊÉÖ
            document.getElementById('detail-title').textContent = post.title;
            document.getElementById('detail-author').textContent = post.author;
            document.getElementById('detail-date').textContent = post.date;
            document.getElementById('detail-content').textContent = post.content;
            document.getElementById('detail-likes').textContent = post.likes;
            
            // ËÆæÁΩÆÂàÜÁ±ª
            const detailCategory = document.getElementById('detail-category');
            detailCategory.textContent = getCategoryName(post.category);
            detailCategory.className = 'post-category ' + post.category;
            
            // Âä†ËΩΩËØÑËÆ∫
            loadComments(post.id);
            
            // Êõ¥Êñ∞ËØÑËÆ∫Êï∞Èáè
            const commentCount = getPostComments(post.id).length;
            document.getElementById('detail-comments').textContent = commentCount;
            
            // ÊòæÁ§∫Á©∫ËØÑËÆ∫ÊèêÁ§∫
            if (commentCount === 0) {
                document.querySelector('.comments-empty').classList.remove('hidden');
            } else {
                document.querySelector('.comments-empty').classList.add('hidden');
            }
            
            // ÊòæÁ§∫ËØÑËÆ∫Ê°Ü
            updateCommentForm();
            
            // Ê∑ªÂä†ÁÇπËµûÊåâÈíÆ‰∫ã‰ª∂
            document.getElementById('detail-like-btn').onclick = function() {
                if (currentUser) {
                    post.likes++;
                    updatePostInStorage(post);
                    document.getElementById('detail-likes').textContent = post.likes;
                    
                    // Êõ¥Êñ∞ÂàóË°®È°µ‰∏≠ÁöÑÁÇπËµûÊï∞
                    const postElement = document.querySelector(`.topic-item[data-post-id="${post.id}"]`);
                    if (postElement) {
                        postElement.querySelector('.likes').innerHTML = `‚ù§Ô∏è ${post.likes}`;
                    }
                } else {
                    alert('ËØ∑ÂÖàÁôªÂΩïÂêéÂÜçÁÇπËµû');
                    document.getElementById('post-detail-modal').classList.add('hidden');
                    loginModal.classList.remove('hidden');
                }
            };
            
            // Ê∑ªÂä†ËØÑËÆ∫Êèê‰∫§‰∫ã‰ª∂
            document.getElementById('submit-comment').onclick = function() {
                addComment(post.id);
            };
            
            // ÊòæÁ§∫Ê®°ÊÄÅÊ°Ü
            document.getElementById('post-detail-modal').classList.remove('hidden');
        }
        
        // Ëé∑ÂèñÂ∏ñÂ≠êËØÑËÆ∫
        function getPostComments(postId) {
            // ÂÖà‰ªélocalStorageËé∑ÂèñËØÑËÆ∫
            const savedComments = localStorage.getItem(`post_comments_${postId}`);
            if (savedComments) {
                try {
                    return JSON.parse(savedComments);
                } catch (e) {
                    console.error("Error parsing comments:", e);
                }
            }
            
            // Â¶ÇÊûúÊ≤°Êúâ‰øùÂ≠òÁöÑËØÑËÆ∫Ôºå‰ΩøÁî®Á§∫‰æãËØÑËÆ∫ÊàñËøîÂõûÁ©∫Êï∞ÁªÑ
            return sampleComments[postId] || [];
        }
        
        // Êõ¥Êñ∞ËØÑËÆ∫Âà∞localStorage
        function saveComments(postId, comments) {
            localStorage.setItem(`post_comments_${postId}`, JSON.stringify(comments));
        }
        
        // Âä†ËΩΩËØÑËÆ∫
        function loadComments(postId) {
            const commentsList = document.getElementById('comments-list');
            const commentsEmpty = commentsList.querySelector('.comments-empty');
            
            // Ê∏ÖÁ©∫ÂΩìÂâçËØÑËÆ∫ÂàóË°®Ôºà‰øùÁïôÁ©∫ËØÑËÆ∫ÊèêÁ§∫Ôºâ
            Array.from(commentsList.children).forEach(child => {
                if (!child.classList.contains('comments-empty')) {
                    child.remove();
                }
            });
            
            // Ëé∑ÂèñËØÑËÆ∫
            const comments = getPostComments(postId);
            
            // ÊòæÁ§∫ÊàñÈöêËóèÁ©∫ËØÑËÆ∫ÊèêÁ§∫
            if (comments.length === 0) {
                commentsEmpty.classList.remove('hidden');
            } else {
                commentsEmpty.classList.add('hidden');
                
                // Ê∏≤ÊüìËØÑËÆ∫
                comments.forEach(comment => {
                    const commentElement = createCommentElement(comment);
                    commentsList.insertBefore(commentElement, commentsEmpty);
                });
            }
        }
        
        // ÂàõÂª∫ËØÑËÆ∫ÂÖÉÁ¥†
        function createCommentElement(comment) {
            const commentElement = document.createElement('div');
            commentElement.className = 'comment-item';
            commentElement.dataset.commentId = comment.id;
            
            commentElement.innerHTML = `
                <div class="comment-header">
                    <div class="comment-author">
                        <img src="../assets/images/community/avatar-default.jpg" class="comment-avatar">
                        <span>${comment.author}</span>
                    </div>
                    <div class="comment-time">${comment.date}</div>
                </div>
                <div class="comment-content">${comment.content}</div>
                <div class="comment-footer">
                    <div class="comment-like" data-liked="false">
                        <span class="comment-like-icon">‚ù§Ô∏è</span>
                        <span class="comment-like-count">${comment.likes}</span>
                    </div>
                    <div class="comment-reply">Reply</div>
                </div>
            `;
            
            // Ê∑ªÂä†ËØÑËÆ∫ÁÇπËµû‰∫ã‰ª∂
            const likeButton = commentElement.querySelector('.comment-like');
            likeButton.addEventListener('click', function() {
                if (currentUser) {
                    const liked = this.getAttribute('data-liked') === 'true';
                    const postId = comment.postId;
                    const comments = getPostComments(postId);
                    const commentObj = comments.find(c => c.id === comment.id);
                    
                    if (commentObj) {
                        if (!liked) {
                            commentObj.likes++;
                            this.setAttribute('data-liked', 'true');
                            this.classList.add('liked');
                        } else {
                            commentObj.likes--;
                            this.setAttribute('data-liked', 'false');
                            this.classList.remove('liked');
                        }
                        
                        this.querySelector('.comment-like-count').textContent = commentObj.likes;
                        saveComments(postId, comments);
                    }
                } else {
                    alert('ËØ∑ÂÖàÁôªÂΩïÂêéÂÜçÁÇπËµû');
                    document.getElementById('post-detail-modal').classList.add('hidden');
                    loginModal.classList.remove('hidden');
                }
            });
            
            // Ê∑ªÂä†ÂõûÂ§ç‰∫ã‰ª∂
            const replyButton = commentElement.querySelector('.comment-reply');
            replyButton.addEventListener('click', function() {
                if (currentUser) {
                    const commentInput = document.getElementById('comment-input');
                    commentInput.focus();
                    commentInput.value = `@${comment.author} `;
                } else {
                    alert('ËØ∑ÂÖàÁôªÂΩïÂêéÂÜçÂõûÂ§ç');
                    document.getElementById('post-detail-modal').classList.add('hidden');
                    loginModal.classList.remove('hidden');
                }
            });
            
            return commentElement;
        }
        
        // Êõ¥Êñ∞ËØÑËÆ∫Ë°®Âçï
        function updateCommentForm() {
            const commentPlaceholder = document.getElementById('comment-placeholder');
            const commentFormContent = document.getElementById('comment-form-content');
            
            if (currentUser) {
                commentPlaceholder.classList.add('hidden');
                commentFormContent.classList.remove('hidden');
                
                // Êõ¥Êñ∞Áî®Êà∑‰ø°ÊÅØ
                document.getElementById('current-user-name').textContent = currentUser.username;
                document.getElementById('current-user-avatar').src = currentUser.avatar;
            } else {
                commentPlaceholder.classList.remove('hidden');
                commentFormContent.classList.add('hidden');
                
                // Ê∑ªÂä†ÁÇπÂáªÁôªÂΩï‰∫ã‰ª∂
                commentPlaceholder.onclick = function() {
                    document.getElementById('post-detail-modal').classList.add('hidden');
                    loginModal.classList.remove('hidden');
                };
            }
        }
        
        // Ê∑ªÂä†ËØÑËÆ∫
        function addComment(postId) {
            if (!currentUser) return;
            
            const commentInput = document.getElementById('comment-input');
            const commentContent = commentInput.value.trim();
            
            if (!commentContent) {
                alert('ËØÑËÆ∫ÂÜÖÂÆπ‰∏çËÉΩ‰∏∫Á©∫');
                return;
            }
            
            // Ëé∑ÂèñÂΩìÂâçËØÑËÆ∫
            const comments = getPostComments(postId);
            
            // ÂàõÂª∫Êñ∞ËØÑËÆ∫
            const newComment = {
                id: Date.now(),
                postId: postId,
                author: currentUser.username,
                content: commentContent,
                date: new Date().toISOString().split('T')[0],
                likes: 0
            };
            
            // Ê∑ªÂä†Âà∞ËØÑËÆ∫ÂàóË°®
            comments.push(newComment);
            
            // ‰øùÂ≠òËØÑËÆ∫
            saveComments(postId, comments);
            
            // Êõ¥Êñ∞UI
            const commentsList = document.getElementById('comments-list');
            const commentsEmpty = commentsList.querySelector('.comments-empty');
            commentsEmpty.classList.add('hidden');
            
            const commentElement = createCommentElement(newComment);
            commentsList.insertBefore(commentElement, commentsEmpty);
            
            // Êõ¥Êñ∞ËØÑËÆ∫Êï∞Èáè
            const commentCount = comments.length;
            document.getElementById('detail-comments').textContent = commentCount;
            
            // Êõ¥Êñ∞ÂàóË°®È°µ‰∏≠ÁöÑÂõûÂ§çÊï∞
            const post = communityPosts.find(p => p.id == postId);
            if (post) {
                post.replies = comments;
                updatePostInStorage(post);
                
                const postElement = document.querySelector(`.topic-item[data-post-id="${postId}"]`);
                if (postElement) {
                    postElement.querySelector('.replies').innerHTML = `üí¨ ${commentCount}`;
                }
            }
            
            // Ê∏ÖÁ©∫ËæìÂÖ•Ê°Ü
            commentInput.value = '';
        }

        // Êõ¥Êñ∞Â∏ñÂ≠êÂà∞Êú¨Âú∞Â≠òÂÇ®
        function updatePostInStorage(post) {
            const postIndex = communityPosts.findIndex(p => p.id == post.id);
            if (postIndex !== -1) {
                communityPosts[postIndex] = post;
                localStorage.setItem('communityPosts', JSON.stringify(communityPosts));
            }
        }

        // ÂàõÂª∫Â∏ñÂ≠êÂÖÉÁ¥†
        function createPostElement(post) {
            const postDiv = document.createElement('div');
            postDiv.className = 'topic-item';
            postDiv.dataset.postId = post.id;
            
            // Ê†πÊçÆÂàÜÁ±ªËÆæÁΩÆÂõæÊ†á
            let icon = 'üí¨';
            if (post.category === 'question') icon = '‚ùì';
            else if (post.category === 'share') icon = 'üìù';
            else if (post.category === 'resource') icon = 'üìö';
            
            postDiv.innerHTML = `
                <div class="topic-icon">${icon}</div>
                <div class="topic-content">
                    <h3 class="topic-title"><a href="#">${post.title}</a></h3>
                    <div class="topic-meta">
                        <span class="topic-category ${post.category}">${getCategoryName(post.category)}</span>
                        <span class="topic-author">Author: ${post.author}</span>
                        <span class="topic-time">${post.date}</span>
                    </div>
                    <p class="topic-preview">${post.content.substring(0, 200)}${post.content.length > 200 ? '...' : ''}</p>
                    <div class="topic-stats">
                        <span class="views">üëÅÔ∏è ${post.views}</span>
                        <span class="replies">üí¨ ${post.replies ? post.replies.length : 0}</span>
                        <span class="likes" style="cursor:pointer;">‚ù§Ô∏è ${post.likes}</span>
                    </div>
                </div>
            `;
            
            return postDiv;
        }

        // Ëé∑ÂèñÂàÜÁ±ªÂêçÁß∞
        function getCategoryName(category) {
            const categories = {
                'question': document.querySelector('[data-i18n="community.categories.questions"]')?.textContent || 'Questions',
                'share': document.querySelector('[data-i18n="community.categories.experiences"]')?.textContent || 'Experiences',
                'discuss': document.querySelector('[data-i18n="community.categories.discussions"]')?.textContent || 'Discussions',
                'resource': document.querySelector('[data-i18n="community.categories.resources"]')?.textContent || 'Resources'
            };
            
            return categories[category] || category;
        }

        // Êõ¥Êñ∞ÁªüËÆ°Êï∞ÊçÆ
        function updateStats() {
            document.getElementById('member-count').textContent = currentUser ? '1,235' : '1,234';
            document.getElementById('active-count').textContent = currentUser ? '457' : '456';
            document.getElementById('topic-count').textContent = communityPosts.length;
        }
        
        // Ê∏≤ÊüìÊéíË°åÊ¶úÊï∞ÊçÆ
        function renderLeaderboard() {
            console.log("Rendering leaderboard");
            
            const leaderboardContainer = document.getElementById('leaderboard-entries');
            if (!leaderboardContainer) {
                console.error("Leaderboard container not found");
                return;
            }
            
            // Clear loading message
            leaderboardContainer.innerHTML = '';
            
            // Sort leaderboard data by score (descending)
            const sortedLeaderboard = [...leaderboardData].sort((a, b) => b.totalScore - a.totalScore);
            
            // Only show top 5
            const topUsers = sortedLeaderboard.slice(0, 5);
            
            // Render each leaderboard entry
            topUsers.forEach((user, index) => {
                const rankClass = index < 3 ? `rank-${index + 1}` : '';
                const userElement = document.createElement('div');
                userElement.className = 'leaderboard-entry';
                
                // Display badges if any
                const badgesHTML = user.badges.length > 0 ? 
                    `<div class="leaderboard-badges">${user.badges.join('')}</div>` : '';
                
                userElement.innerHTML = `
                    <div class="leaderboard-rank ${rankClass}">${index + 1}</div>
                    <div class="leaderboard-user">
                        <img src="${user.avatar}" alt="${user.username}" class="leaderboard-avatar">
                        <span class="leaderboard-username">${user.username}</span>
                        ${badgesHTML}
                    </div>
                    <div class="leaderboard-score">${user.totalScore}</div>
                `;
                
                leaderboardContainer.appendChild(userElement);
            });
            
            // Add event listener to "View Full Leaderboard" link
            const viewAllLink = document.querySelector('.view-all-link');
            if (viewAllLink) {
                viewAllLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    openFullLeaderboard();
                });
            }
        }
        
        // Open full leaderboard modal and populate data
        function openFullLeaderboard() {
            console.log("Opening full leaderboard");
            
            // Populate full leaderboard
            populateFullLeaderboard('score');
            
            // Show modal
            document.getElementById('leaderboard-modal').classList.remove('hidden');
            
            // Add tab switching functionality if not already added
            const tabs = document.querySelectorAll('.leaderboard-tab');
            tabs.forEach(tab => {
                // Remove existing listeners to avoid duplicates
                const newTab = tab.cloneNode(true);
                tab.parentNode.replaceChild(newTab, tab);
                
                newTab.addEventListener('click', function() {
                    const tabType = this.getAttribute('data-tab');
                    
                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Update leaderboard based on selected tab
                    populateFullLeaderboard(tabType);
                });
            });
        }
        
        // Populate the full leaderboard table based on the selected tab
        function populateFullLeaderboard(tabType) {
            const tableBody = document.getElementById('full-leaderboard-body');
            if (!tableBody) return;
            
            tableBody.innerHTML = '';
            
            // Sort data based on the selected tab
            let sortedData = [...leaderboardData];
            
            if (tabType === 'score') {
                sortedData.sort((a, b) => b.totalScore - a.totalScore);
            } else if (tabType === 'progress') {
                sortedData.sort((a, b) => b.progressPercent - a.progressPercent);
            } else if (tabType === 'contributions') {
                // For demo purposes, sort by username
                sortedData.sort((a, b) => a.username.localeCompare(b.username));
            }
            
            // Populate table rows
            sortedData.forEach((user, index) => {
                const rankClass = index < 3 ? 'top-rank rank-' + (index + 1) : '';
                const row = document.createElement('tr');
                
                // Get value to display based on tab
                let valueToShow = user.totalScore;
                if (tabType === 'progress') {
                    valueToShow = user.progressPercent + '%';
                } else if (tabType === 'contributions') {
                    // Mock contribution count for demo
                    const contributionCount = Math.floor(Math.random() * 50) + 5;
                    valueToShow = contributionCount;
                }
                
                row.innerHTML = `
                    <td class="rank-cell ${rankClass}">${index + 1}</td>
                    <td>
                        <div class="user-cell">
                            <img src="${user.avatar}" alt="${user.username}" class="user-avatar">
                            <span>${user.username}</span>
                        </div>
                    </td>
                    <td>${valueToShow}</td>
                    <td class="badge-cell">${user.badges.join(' ')}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // ÁªëÂÆöÊâÄÊúâ‰∫ã‰ª∂ÁõëÂê¨Âô®
        function bindEventListeners() {
            console.log("Binding event listeners");
            
            // ÁªëÂÆöÁôªÂΩïÈìæÊé•‰∫ã‰ª∂
            const loginLink = document.getElementById('login-link');
            if (loginLink) {
                console.log("Login link found, binding click event");
                loginLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log("Login link clicked");
                    loginModal.classList.remove('hidden');
                });
            } else {
                console.warn("Login link not found");
            }
            
            // ÁªëÂÆöÂèëÂ∏ÉÊñ∞Â∏ñÂ≠êÊåâÈíÆ‰∫ã‰ª∂
            newPostBtn.addEventListener('click', function() {
                console.log("New post button clicked");
                if (currentUser) {
                    newTopicModal.classList.remove('hidden');
                } else {
                    loginModal.classList.remove('hidden');
                }
            });
            
            // ÁªëÂÆöÁôªÂΩïË°®ÂçïÊèê‰∫§‰∫ã‰ª∂
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                console.log("Login form submitted");
                
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                
                if (username && password) {
                    // Get achievements data if available for this user
                    const achievements = mockUserAchievements[username] || {
                        learningProgress: "10% Complete",
                        gameScore: "50 Points",
                        badges: ["Newcomer"]
                    };
                    
                    // Get profile data if available
                    const profile = userProfiles[username] || {
                        bio: "Ëøô‰∏™Áî®Êà∑ËøòÊ≤°ÊúâÊ∑ªÂä†‰∏™‰∫∫ÁÆÄ‰ªã„ÄÇ",
                        interests: "Êú™ÊåáÂÆöÂÖ¥Ë∂£"
                    };
                    
                    // ÁÆÄÂçïÁôªÂΩïÈÄªËæë
                    currentUser = {
                        username: username,
                        avatar: '../assets/images/community/avatar-default.jpg',
                        achievements: achievements,
                        profile: profile
                    };
                    
                    // ‰øùÂ≠òÁî®Êà∑‰ø°ÊÅØ
                    localStorage.setItem('communityUser', JSON.stringify(currentUser));
                    
                    // Êõ¥Êñ∞UI
                    updateUserUI(currentUser);
                    updateStats();
                    
                    // ÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü
                    loginModal.classList.add('hidden');
                    
                    // Ê∏ÖÁ©∫Ë°®Âçï
                    document.getElementById('username').value = '';
                    document.getElementById('password').value = '';
                    
                    console.log("User logged in:", currentUser.username);
                }
            });
            
            // ÁªëÂÆöÊñ∞Â∏ñÂ≠êË°®ÂçïÊèê‰∫§‰∫ã‰ª∂
            newTopicForm.addEventListener('submit', function(e) {
                e.preventDefault();
                console.log("New topic form submitted");
                
                if (!currentUser) {
                    alert('ËØ∑ÂÖàÁôªÂΩïÂêéÂÜçÂèëÂ∏ÉËÆ®ËÆ∫');
                    loginModal.classList.remove('hidden');
                    return;
                }
                
                const title = document.getElementById('topic-title').value;
                const category = document.getElementById('topic-category').value;
                const content = document.getElementById('topic-content').value;
                
                if (!title || !category || !content) {
                    alert('ËØ∑Â°´ÂÜôÊâÄÊúâÂ≠óÊÆµ');
                    return;
                }
                
                // ÂàõÂª∫Êñ∞Â∏ñÂ≠ê
                const newPost = {
                    id: Date.now(),
                    title: title,
                    category: category,
                    content: content,
                    author: currentUser.username,
                    date: new Date().toISOString().split('T')[0],
                    views: 0,
                    likes: 0,
                    replies: []
                };
                
                console.log("New post created:", newPost);
                
                // Ê∑ªÂä†Âà∞Â∏ñÂ≠êÂàóË°®
                communityPosts.push(newPost);
                
                // ‰øùÂ≠òÂà∞localStorage
                localStorage.setItem('communityPosts', JSON.stringify(communityPosts));
                
                // ÈáçÊñ∞Ê∏≤ÊüìÂ∏ñÂ≠ê
                renderPosts();
                
                // Êõ¥Êñ∞ÁªüËÆ°
                updateStats();
                
                // ÂÖ≥Èó≠Ê®°ÊÄÅÊ°ÜÂπ∂Ê∏ÖÁ©∫Ë°®Âçï
                newTopicModal.classList.add('hidden');
                document.getElementById('topic-title').value = '';
                document.getElementById('topic-category').value = '';
                document.getElementById('topic-content').value = '';
                
                console.log("New post added and UI updated");
            });
            
            // ÁªëÂÆöÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü‰∫ã‰ª∂
            closeModals.forEach(button => {
                button.addEventListener('click', function() {
                    loginModal.classList.add('hidden');
                    newTopicModal.classList.add('hidden');
                });
            });
            
            // ÁªëÂÆöÂèñÊ∂àÊñ∞Â∏ñÂ≠ê‰∫ã‰ª∂
            cancelButton.addEventListener('click', function() {
                newTopicModal.classList.add('hidden');
            });
            
            // ÁªëÂÆöÂàÜÁ±ªÁ≠õÈÄâ‰∫ã‰ª∂
            categoryButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const category = this.getAttribute('data-category');
                    
                    // ÁßªÈô§ÊâÄÊúâactiveÁ±ª
                    categoryButtons.forEach(btn => btn.classList.remove('active'));
                    
                    // Ê∑ªÂä†activeÂà∞ÂΩìÂâçÊåâÈíÆ
                    this.classList.add('active');
                    
                    // Á≠õÈÄâÂ∏ñÂ≠ê
                    const topicItems = document.querySelectorAll('.topic-item:not(.pinned)');
                    topicItems.forEach(item => {
                        const itemCategory = item.querySelector('.topic-category');
                        if (category === 'all' || (itemCategory && itemCategory.classList.contains(category))) {
                            item.style.display = 'flex';
                        } else {
                            item.style.display = 'none';
                        }
                    });
                });
            });
            
            // ÁªëÂÆöÊêúÁ¥¢ÂäüËÉΩ
            document.getElementById('search-btn').addEventListener('click', function() {
                const searchText = document.getElementById('community-search').value.toLowerCase();
                if (!searchText) return;
                
                const topicItems = document.querySelectorAll('.topic-item:not(.pinned)');
                topicItems.forEach(item => {
                    const title = item.querySelector('.topic-title').textContent.toLowerCase();
                    const content = item.querySelector('.topic-preview').textContent.toLowerCase();
                    
                    if (title.includes(searchText) || content.includes(searchText)) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
                
                // ÈáçÁΩÆÂàÜÁ±ªÊåâÈíÆÁä∂ÊÄÅ
                categoryButtons.forEach(btn => btn.classList.remove('active'));
                document.querySelector('.category-btn[data-category="all"]').classList.add('active');
            });
        }

        // ÊâìÂºÄ‰∏™‰∫∫ËµÑÊñôÁºñËæëÂô®
        function openProfileEditor() {
            console.log("Opening profile editor");
            
            // Á°Æ‰øùÁî®Êà∑Â∑≤ÁôªÂΩï
            if (!currentUser) {
                alert('ËØ∑ÂÖàÁôªÂΩïÂêéÂÜçÁºñËæë‰∏™‰∫∫ËµÑÊñô');
                loginModal.classList.remove('hidden');
                return;
            }
            
            // Â°´ÂÖÖË°®ÂçïÊï∞ÊçÆ
            const usernameField = document.getElementById('edit-username');
            const bioField = document.getElementById('edit-bio');
            const interestsField = document.getElementById('edit-interests');
            const avatarPreview = document.getElementById('current-avatar-preview');
            
            usernameField.value = currentUser.username;
            bioField.value = currentUser.profile?.bio || '';
            interestsField.value = currentUser.profile?.interests || '';
            avatarPreview.src = currentUser.avatar;
            
            // ËÆæÁΩÆË°®ÂçïÊèê‰∫§‰∫ã‰ª∂
            const profileForm = document.getElementById('profile-edit-form');
            profileForm.onsubmit = function(e) {
                e.preventDefault();
                saveProfileChanges();
            };
            
            // ËÆæÁΩÆÂ§¥ÂÉèÈÄâÊã©‰∫ã‰ª∂
            const avatarOptions = document.querySelectorAll('.avatar-option');
            avatarOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // ÁßªÈô§ÂÖ∂‰ªñÈÄâÈ°πÁöÑÈÄâ‰∏≠Áä∂ÊÄÅ
                    avatarOptions.forEach(opt => opt.classList.remove('selected'));
                    // Ê∑ªÂä†ÈÄâ‰∏≠Áä∂ÊÄÅÂà∞ÂΩìÂâçÈÄâÈ°π
                    this.classList.add('selected');
                    // Êõ¥Êñ∞Â§¥ÂÉèÈ¢ÑËßà
                    const avatarSrc = this.getAttribute('data-avatar');
                    avatarPreview.src = avatarSrc;
                    document.getElementById('edit-avatar').value = avatarSrc;
                });
            });
            
            // ÊòæÁ§∫Ê®°ÊÄÅÊ°Ü
            document.getElementById('profile-edit-modal').classList.remove('hidden');
        }
        
        // ‰øùÂ≠ò‰∏™‰∫∫ËµÑÊñôÊõ¥Êîπ
        function saveProfileChanges() {
            const username = document.getElementById('edit-username').value.trim();
            const bio = document.getElementById('edit-bio').value.trim();
            const interests = document.getElementById('edit-interests').value.trim();
            const avatar = document.getElementById('edit-avatar').value;
            
            if (!username) {
                alert('Áî®Êà∑Âêç‰∏çËÉΩ‰∏∫Á©∫');
                return;
            }
            
            // Êõ¥Êñ∞Áî®Êà∑Êï∞ÊçÆ
            const oldUsername = currentUser.username;
            currentUser.username = username;
            currentUser.avatar = avatar;
            currentUser.profile = {
                ...currentUser.profile,
                bio: bio,
                interests: interests
            };
            
            // ‰øùÂ≠òÂà∞localStorage
            localStorage.setItem('communityUser', JSON.stringify(currentUser));
            
            // Â¶ÇÊûúÁî®Êà∑ÂêçÂ∑≤Êõ¥ÊîπÔºåÊõ¥Êñ∞Â∏ñÂ≠êÂíåËØÑËÆ∫‰∏≠ÁöÑ‰ΩúËÄÖÂêç
            if (oldUsername !== username) {
                updateAuthorReferences(oldUsername, username);
            }
            
            // Êõ¥Êñ∞UI
            updateUserUI(currentUser);
            
            // ÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü
            document.getElementById('profile-edit-modal').classList.add('hidden');
            
            console.log("Profile updated:", currentUser);
        }
        
        // Êõ¥Êñ∞Â∏ñÂ≠êÂíåËØÑËÆ∫‰∏≠ÁöÑ‰ΩúËÄÖÂºïÁî®
        function updateAuthorReferences(oldUsername, newUsername) {
            // Êõ¥Êñ∞Áî®Êà∑ÂèëÂ∏ÉÁöÑÂ∏ñÂ≠ê
            communityPosts.forEach(post => {
                if (post.author === oldUsername) {
                    post.author = newUsername;
                }
            });
            
            // Êõ¥Êñ∞localStorage‰∏≠ÁöÑÂ∏ñÂ≠ê
            localStorage.setItem('communityPosts', JSON.stringify(communityPosts));
            
            // Êõ¥Êñ∞ËØÑËÆ∫
            for (const postId in sampleComments) {
                const comments = sampleComments[postId];
                let updated = false;
                
                comments.forEach(comment => {
                    if (comment.author === oldUsername) {
                        comment.author = newUsername;
                        updated = true;
                    }
                });
                
                if (updated) {
                    saveComments(postId, comments);
                }
            }
        }

        // ÂàùÂßãÂåñÁ§æÂå∫
        initCommunity();
    });
    </script>

    <!-- Ê∑ªÂä†È¢ùÂ§ñÁöÑÊ†∑ÂºèÁ°Æ‰øùÊ®°ÊÄÅÊ°ÜÊ≠£Á°ÆÊòæÁ§∫ -->
    <style>
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.7);
        z-index: 1000;
        justify-content: center;
        align-items: center;
    }

    .modal:not(.hidden) {
        display: flex;
    }

    .modal-content {
        background-color: #fff;
        padding: 20px;
        border-radius: 5px;
        width: 80%;
        max-width: 500px;
        position: relative;
    }

    .modal.dark-mode .modal-content {
        background-color: #333;
        color: #fff;
    }

    .close, .close-modal {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 24px;
        cursor: pointer;
    }
    
    /* User Achievements Styles */
    .user-achievements {
        margin: 15px 0;
        background-color: #f8f9fa;
        border-radius: 8px;
        padding: 12px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    
    .dark-mode .user-achievements {
        background-color: #2a2a2a;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    .achievements-header {
        margin-bottom: 8px;
        border-bottom: 1px solid #e5e5e5;
        padding-bottom: 5px;
    }
    
    .achievements-header h4 {
        margin: 0;
        font-size: 16px;
        color: #444;
    }
    
    .dark-mode .achievements-header h4 {
        color: #ddd;
    }
    
    .achievement-items {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .achievement-item {
        display: flex;
        align-items: center;
        font-size: 14px;
    }
    
    .achievement-icon {
        margin-right: 8px;
        font-size: 16px;
    }
    
    .achievement-label {
        color: #666;
        flex: 1;
    }
    
    .dark-mode .achievement-label {
        color: #aaa;
    }
    
    .achievement-value {
        font-weight: 600;
        color: #2c7be5;
    }
    
    .dark-mode .achievement-value {
        color: #4d9fff;
    }
    
    /* Star Learners Styles */
    .star-learners {
        margin-top: 20px;
        background-color: #f8f9fa;
        border-radius: 8px;
        padding: 15px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    
    .dark-mode .star-learners {
        background-color: #2a2a2a;
        box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    
    .star-learners h3 {
        margin: 0 0 10px 0;
        color: #333;
        font-size: 18px;
        display: flex;
        align-items: center;
    }
    
    .dark-mode .star-learners h3 {
        color: #eee;
    }
    
    .star-learners h3:before {
        content: 'üèÜ';
        margin-right: 8px;
    }
    
    .leaderboard-description {
        font-size: 13px;
        color: #666;
        margin-bottom: 15px;
    }
    
    .dark-mode .leaderboard-description {
        color: #aaa;
    }
    
    .leaderboard-entries {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-bottom: 12px;
    }
    
    .leaderboard-entry {
        display: flex;
        align-items: center;
        padding: 8px 10px;
        background-color: white;
        border-radius: 6px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    
    .leaderboard-entry:hover {
        transform: translateY(-2px);
        box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    }
    
    .dark-mode .leaderboard-entry {
        background-color: #333;
        box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }
    
    .dark-mode .leaderboard-entry:hover {
        box-shadow: 0 3px 6px rgba(0,0,0,0.3);
    }
    
    .leaderboard-rank {
        font-weight: bold;
        font-size: 16px;
        width: 25px;
        text-align: center;
    }
    
    .rank-1 {
        color: gold;
    }
    
    .rank-2 {
        color: silver;
    }
    
    .rank-3 {
        color: #cd7f32; /* bronze */
    }
    
    .leaderboard-user {
        display: flex;
        align-items: center;
        flex: 1;
    }
    
    .leaderboard-avatar {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        margin-right: 8px;
    }
    
    .leaderboard-username {
        font-weight: 500;
        font-size: 14px;
    }
    
    .leaderboard-score {
        font-weight: 600;
        color: #2c7be5;
        font-size: 14px;
    }
    
    .dark-mode .leaderboard-score {
        color: #4d9fff;
    }
    
    .leaderboard-badges {
        margin-left: 8px;
        display: flex;
        gap: 2px;
    }
    
    .leaderboard-badge {
        font-size: 12px;
    }
    
    .leaderboard-loading {
        text-align: center;
        padding: 15px 0;
        color: #666;
        font-style: italic;
    }
    
    .dark-mode .leaderboard-loading {
        color: #aaa;
    }
    
    .view-all-link {
        font-size: 13px;
        color: #2c7be5;
        text-decoration: none;
        display: block;
        text-align: center;
    }
    
    .view-all-link:hover {
        text-decoration: underline;
    }
    
    .dark-mode .view-all-link {
        color: #4d9fff;
    }
    
    /* Full Leaderboard Modal Styles */
    .full-leaderboard-container {
        margin-top: 20px;
    }
    
    .leaderboard-tabs {
        display: flex;
        border-bottom: 1px solid #ddd;
        margin-bottom: 15px;
    }
    
    .dark-mode .leaderboard-tabs {
        border-bottom-color: #444;
    }
    
    .leaderboard-tab {
        padding: 10px 15px;
        background: none;
        border: none;
        border-bottom: 3px solid transparent;
        cursor: pointer;
        font-size: 14px;
        color: #666;
        transition: all 0.2s ease;
    }
    
    .leaderboard-tab.active {
        border-bottom-color: #2c7be5;
        color: #2c7be5;
        font-weight: 600;
    }
    
    .dark-mode .leaderboard-tab {
        color: #aaa;
    }
    
    .dark-mode .leaderboard-tab.active {
        border-bottom-color: #4d9fff;
        color: #4d9fff;
    }
    
    .leaderboard-table-container {
        max-height: 400px;
        overflow-y: auto;
    }
    
    .leaderboard-table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .leaderboard-table th,
    .leaderboard-table td {
        padding: 10px;
        text-align: left;
        border-bottom: 1px solid #eee;
    }
    
    .dark-mode .leaderboard-table th,
    .dark-mode .leaderboard-table td {
        border-bottom-color: #444;
    }
    
    .leaderboard-table th {
        background-color: #f5f7fa;
        font-weight: 600;
        color: #333;
    }
    
    .dark-mode .leaderboard-table th {
        background-color: #2a2a2a;
        color: #eee;
    }
    
    .leaderboard-table tr:hover {
        background-color: #f5f7fa;
    }
    
    .dark-mode .leaderboard-table tr:hover {
        background-color: #2a2a2a;
    }
    
    .leaderboard-table .user-cell {
        display: flex;
        align-items: center;
    }
    
    .leaderboard-table .user-avatar {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        margin-right: 10px;
    }
    
    .leaderboard-table .badge-cell {
        display: flex;
        gap: 5px;
    }
    
    .leaderboard-table .rank-cell {
        font-weight: bold;
        width: 50px;
    }
    
    .leaderboard-table .top-rank {
        font-size: 16px;
    }
    
    /* Post Detail Modal Styles */
    .post-detail-content {
        max-width: 800px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
    }
    
    .post-detail-container {
        padding: 10px 0;
    }
    
    .post-detail-header {
        margin-bottom: 20px;
    }
    
    .post-category {
        display: inline-block;
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 12px;
        font-weight: 600;
        background-color: #e9ecef;
        color: #495057;
        margin-bottom: 10px;
    }
    
    .dark-mode .post-category {
        background-color: #2a2a2a;
        color: #ddd;
    }
    
    .post-title {
        margin: 0 0 15px 0;
        font-size: 24px;
        line-height: 1.3;
        color: #333;
    }
    
    .dark-mode .post-title {
        color: #eee;
    }
    
    .post-meta {
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 14px;
        color: #6c757d;
        margin-bottom: 15px;
    }
    
    .post-author {
        display: flex;
        align-items: center;
    }
    
    .author-avatar {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        margin-right: 10px;
    }
    
    .post-detail-body {
        font-size: 16px;
        line-height: 1.6;
        color: #333;
        margin-bottom: 20px;
        padding-bottom: 20px;
        border-bottom: 1px solid #eee;
    }
    
    .dark-mode .post-detail-body {
        color: #ddd;
        border-bottom-color: #444;
    }
    
    .post-detail-actions {
        display: flex;
        margin-bottom: 25px;
    }
    
    .action-btn {
        background: none;
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        margin-right: 20px;
        font-size: 14px;
        color: #6c757d;
        padding: 8px 12px;
        border-radius: 20px;
        transition: background-color 0.2s ease;
    }
    
    .action-btn:hover {
        background-color: #f0f2f5;
    }
    
    .dark-mode .action-btn:hover {
        background-color: #2a2a2a;
    }
    
    .action-btn.liked {
        color: #e74c3c;
    }
    
    .action-icon {
        margin-right: 5px;
        font-size: 16px;
    }
    
    .action-count {
        margin-right: 5px;
        font-weight: 600;
    }
    
    /* Comments Section Styles */
    .post-comments-section {
        margin-top: 20px;
    }
    
    .comments-title {
        font-size: 18px;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 1px solid #eee;
        color: #333;
    }
    
    .dark-mode .comments-title {
        color: #eee;
        border-bottom-color: #444;
    }
    
    .comment-form {
        margin-bottom: 25px;
    }
    
    .comment-form-placeholder {
        padding: 15px;
        background-color: #f8f9fa;
        border-radius: 8px;
        text-align: center;
        color: #6c757d;
        cursor: pointer;
    }
    
    .dark-mode .comment-form-placeholder {
        background-color: #2a2a2a;
        color: #aaa;
    }
    
    .comment-form-content {
        background-color: #f8f9fa;
        border-radius: 8px;
        padding: 15px;
    }
    
    .dark-mode .comment-form-content {
        background-color: #2a2a2a;
    }
    
    .comment-user {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
    }
    
    .comment-avatar {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        margin-right: 10px;
    }
    
    .comment-input {
        width: 100%;
        min-height: 80px;
        padding: 10px;
        border: 1px solid #ced4da;
        border-radius: 4px;
        resize: vertical;
        margin-bottom: 10px;
        font-family: inherit;
        font-size: 14px;
    }
    
    .dark-mode .comment-input {
        background-color: #333;
        border-color: #555;
        color: #eee;
    }
    
    .comment-actions {
        display: flex;
        justify-content: flex-end;
    }
    
    .comments-list {
        margin-top: 20px;
    }
    
    .comment-item {
        margin-bottom: 20px;
        padding-bottom: 20px;
        border-bottom: 1px solid #eee;
    }
    
    .dark-mode .comment-item {
        border-bottom-color: #444;
    }
    
    .comment-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
    }
    
    .comment-author {
        display: flex;
        align-items: center;
    }
    
    .comment-time {
        font-size: 12px;
        color: #6c757d;
    }
    
    .comment-content {
        font-size: 14px;
        line-height: 1.5;
        margin-bottom: 10px;
        color: #333;
    }
    
    .dark-mode .comment-content {
        color: #ddd;
    }
    
    .comment-footer {
        display: flex;
        align-items: center;
    }
    
    .comment-like {
        display: flex;
        align-items: center;
        font-size: 12px;
        color: #6c757d;
        cursor: pointer;
        margin-right: 15px;
    }
    
    .comment-like.liked {
        color: #e74c3c;
    }
    
    .comment-like-icon {
        margin-right: 5px;
    }
    
    .comment-reply {
        font-size: 12px;
        color: #6c757d;
        cursor: pointer;
    }
    
    .comments-empty {
        text-align: center;
        color: #6c757d;
        padding: 20px 0;
        font-style: italic;
    }
    
    .hidden {
        display: none !important;
    }
    
    /* Profile Edit Styles */
    .edit-profile-btn {
        background: none;
        border: 1px solid #ced4da;
        border-radius: 4px;
        padding: 4px 8px;
        font-size: 12px;
        color: #6c757d;
        cursor: pointer;
        margin-top: 5px;
        transition: all 0.2s ease;
    }
    
    .edit-profile-btn:hover {
        background-color: #f8f9fa;
        color: #495057;
    }
    
    .dark-mode .edit-profile-btn {
        border-color: #555;
        color: #aaa;
    }
    
    .dark-mode .edit-profile-btn:hover {
        background-color: #2a2a2a;
        color: #eee;
    }
    
    .user-bio {
        margin-top: 15px;
        background-color: #f8f9fa;
        border-radius: 8px;
        padding: 12px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        display: none;
    }
    
    .dark-mode .user-bio {
        background-color: #2a2a2a;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    .bio-header {
        margin-bottom: 8px;
        padding-bottom: 5px;
    }
    
    .bio-header h4 {
        margin: 0;
        font-size: 15px;
        color: #444;
    }
    
    .dark-mode .bio-header h4 {
        color: #ddd;
    }
    
    .bio-content, .bio-interests {
        font-size: 13px;
        color: #666;
        margin: 0 0 15px 0;
        line-height: 1.4;
    }
    
    .dark-mode .bio-content, .dark-mode .bio-interests {
        color: #aaa;
    }
    
    /* Avatar Selection */
    .avatar-selection {
        display: flex;
        flex-direction: column;
    }
    
    .current-avatar {
        margin-bottom: 10px;
        text-align: center;
    }
    
    .current-avatar img {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        border: 3px solid #fff;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    
    .dark-mode .current-avatar img {
        border-color: #333;
        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }
    
    .avatar-options {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin-bottom: 10px;
    }
    
    .avatar-option {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        cursor: pointer;
        border: 2px solid transparent;
        transition: all 0.2s ease;
        overflow: hidden;
    }
    
    .avatar-option img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    .avatar-option.selected {
        border-color: #2c7be5;
        transform: scale(1.1);
    }
    
    .dark-mode .avatar-option.selected {
        border-color: #4d9fff;
    }
    </style>
</body>
</html> 